table(overlaps)
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Diseased_H3K4Me3_GRCh38_chr1.bigBed")
helChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38_chr1.bigBed")
overlaps <- overlapsAny(disChr1H3K4Me3, helChr1H3K4Me3)
table(overlaps)
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Diseased_H3K4Me3_GRCh38_chr1.bigBed")
helChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38_chr1.bigBed")
overlaps <- overlapsAny(disChr1H3K4Me3, helChr1H3K4Me3)
table(overlaps)
nonOverlaps <- !overlaps
table(nonOverlaps)
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Diseased_H3K4Me3_GRCh38_chr1.bigBed")
helChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38_chr1.bigBed")
overlaps <- overlapsAny(disChr1H3K4Me3, helChr1H3K4Me3)
table(overlaps)
nonOverlaps <- !overlaps
table(nonOverlaps)
nonOverlapsPeaks <- disChr1H3K4Me3[nonOverlaps]
length(nonOverlapsPeaks)
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Diseased_H3K4Me3_GRCh38_chr1.bigBed")
helChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38_chr1.bigBed")
overlaps <- overlapsAny(disChr1H3K4Me3, helChr1H3K4Me3)
table(overlaps)
nonOverlaps <- !overlaps
table(nonOverlaps)
nonOverlapsPeaks <- disChr1H3K4Me3[nonOverlaps]
length(nonOverlapsPeaks)
rtracklayer::export(nonOverlapsPeaks, "ENCODE_peaks/H3K4Me3/Diseased_Exclusive_H3K4Me3_chr1.bigBed")
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Diseased_H3K4Me3_GRCh38_chr1.bigBed")
helChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38_chr1.bigBed")
overlaps <- overlapsAny(disChr1H3K4Me3, helChr1H3K4Me3)
table(overlaps)
nonOverlaps <- !overlaps
table(nonOverlaps)
nonOverlapsPeaks <- disChr1H3K4Me3[nonOverlaps]
length(nonOverlapsPeaks)
rtracklayer::export(nonOverlapsPeaks, "ENCODE_peaks/H3K4Me3/Diseased_Exclusive_H3K4Me3_GRCh38_chr1.bigBed")
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Diseased_H3K4Me3_GRCh38_chr1.bigBed")
helChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38_chr1.bigBed")
overlaps <- overlapsAny(disChr1H3K4Me3, helChr1H3K4Me3)
table(overlaps)
nonOverlaps <- !overlaps
table(nonOverlaps)
nonOverlapsPeaks <- disChr1H3K4Me3[nonOverlaps]
length(nonOverlapsPeaks)
rtracklayer::export(nonOverlapsPeaks, "test_chr1.bigBed")
nonOverlapsPeaks
disChr1H3K4Me3
disChr1H3K27Ac
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Diseased_H3K4Me3_GRCh38_chr1.bigBed")
helChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38_chr1.bigBed")
overlaps <- overlapsAny(disChr1H3K4Me3, helChr1H3K4Me3)
table(overlaps)
nonOverlaps <- !overlaps
table(nonOverlaps)
nonOverlapsPeaks <- disChr1H3K4Me3[nonOverlaps]
length(nonOverlapsPeaks)
rtracklayer::export(nonOverlapsPeaks, "ENCODE_peaks/H3K4Me3/Diseased_Exclusive_H3K4Me3_GRCh38_chr1.bigBed")
nonOverlapsPeaks$strand
?rtracklayer::export
??export
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Diseased_H3K4Me3_GRCh38_chr1.bigBed")
helChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38_chr1.bigBed")
overlaps <- overlapsAny(disChr1H3K4Me3, helChr1H3K4Me3)
table(overlaps)
nonOverlaps <- !overlaps
table(nonOverlaps)
nonOverlapsPeaks <- disChr1H3K4Me3[nonOverlaps]
length(nonOverlapsPeaks)
rtracklayer::export.bb(nonOverlapsPeaks, "ENCODE_peaks/H3K4Me3/Diseased_Exclusive_H3K4Me3_GRCh38_chr1.bigBed")
helChr1H3K27Ac
strand(disChr1H3K4Me3)
knitr::opts_chunk$set(echo = TRUE)
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Diseased_H3K4Me3_GRCh38_chr1.bigBed")
helChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38_chr1.bigBed")
overlaps <- overlapsAny(disChr1H3K4Me3, helChr1H3K4Me3)
suppressPackageStartupMessages({
library(epiwraps)
library(rtracklayer)
library(GenomicRanges)
})
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Diseased_H3K4Me3_GRCh38_chr1.bigBed")
helChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38_chr1.bigBed")
overlaps <- overlapsAny(disChr1H3K4Me3, helChr1H3K4Me3)
table(overlaps)
nonOverlaps <- !overlaps
table(nonOverlaps)
nonOverlapsPeaks <- disChr1H3K4Me3[nonOverlaps]
length(nonOverlapsPeaks)
rtracklayer::export(nonOverlapsPeaks, "ENCODE_peaks/H3K4Me3/Diseased_Exclusive_H3K4Me3_GRCh38_chr1.bigBed")
names(nonOverlapsPeaks)
nonOverlapsPeaks[['strand']] <- NULL
nonOverlapsPeaks
nonOverlapsPeaks$strand <- NULL
nonOverlapsPeaks
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Diseased_H3K4Me3_GRCh38_chr1.bigBed")
helChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38_chr1.bigBed")
overlaps <- overlapsAny(disChr1H3K4Me3, helChr1H3K4Me3)
table(overlaps)
nonOverlaps <- !overlaps
table(nonOverlaps)
nonOverlapsPeaks <- disChr1H3K4Me3[nonOverlaps]
length(nonOverlapsPeaks)
rtracklayer::export(nonOverlapsPeaks, "ENCODE_peaks/H3K4Me3/Diseased_Exclusive_H3K4Me3_GRCh38_chr1.bed")
marks <- c("H3K4Me3", "H3K9Me3", "H3K27Ac", "H3K27Me3")
for (mark in marks) {
print(mark)
}
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Diseased_H3K4Me3_GRCh38_chr1.bigBed")
helChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38_chr1.bigBed")
overlaps <- overlapsAny(disChr1H3K4Me3, helChr1H3K4Me3)
table(overlaps)
nonOverlaps <- !overlaps
table(nonOverlaps)
nonOverlapsPeaks <- disChr1H3K4Me3[nonOverlaps]
length(nonOverlapsPeaks)
rtracklayer::export(nonOverlapsPeaks, "ENCODE_peaks/H3K4Me3/Diseased_Exclusive_H3K4Me3_GRCh38_chr1.bed")
for (mark in marks) {
diseasedPath <- "ENCODE_peaks/MARK/Diseased_MARK_GRCh38_chr1.bigBed"
diseasedPath <- gsub("MARK", mark, diseasedPath)
print(diseasedPath)
diseasedPeaks <- rtracklayer::import(diseasedPath)
healthyPath <- "ENCODE_peaks/MARK/Healthy_MARK_GRCh38_chr1.bigBed"
healthyPath <- gsub("MARK", mark, healthyPath)
print(healthyPath)
healthyPeaks <- rtracklayer::import(healthyPath)
}
marks <- c("H3K4Me3", "H3K9Me3", "H3K27Ac", "H3K27Me3")
for (mark in marks) {
diseasedPath <- "ENCODE_peaks/MARK/Diseased_MARK_GRCh38_chr1.bigBed"
diseasedPath <- gsub("MARK", mark, diseasedPath)
print(diseasedPath)
diseasedPeaks <- rtracklayer::import(diseasedPath)
healthyPath <- "ENCODE_peaks/MARK/Healthy_MARK_GRCh38_chr1.bigBed"
healthyPath <- gsub("MARK", mark, healthyPath)
print(healthyPath)
healthyPeaks <- rtracklayer::import(healthyPath)
overlaps <- overlapsAny(diseasedPeaks, healthyPeaks)
table(overlaps)
nonOverlaps <- !overlaps
table(nonOverlaps)
nonOverlapsPeaks <- diseasedPeaks[nonOverlaps]
length(nonOverlapsPeaks)
exportPath <- "ENCODE_peaks/MARK/Diseased_Exclusive_MARK_GRCh38_chr1.bed"
exportPath <- gsub("MARK", mark, exportPath)
rtracklayer::export(nonOverlapsPeaks, exportPath)
}
marks <- c("H3K4Me3", "H3K9Me3", "H3K27Ac", "H3K27Me3")
for (mark in marks) {
diseasedPath <- "ENCODE_peaks/MARK/Diseased_MARK_GRCh38.bigBed"
diseasedPath <- gsub("MARK", mark, diseasedPath)
print(diseasedPath)
diseasedPeaks <- rtracklayer::import(diseasedPath)
healthyPath <- "ENCODE_peaks/MARK/Healthy_MARK_GRCh38.bigBed"
healthyPath <- gsub("MARK", mark, healthyPath)
print(healthyPath)
healthyPeaks <- rtracklayer::import(healthyPath)
overlaps <- overlapsAny(diseasedPeaks, healthyPeaks)
table(overlaps)
nonOverlaps <- !overlaps
table(nonOverlaps)
nonOverlapsPeaks <- diseasedPeaks[nonOverlaps]
length(nonOverlapsPeaks)
exportPath <- "ENCODE_peaks/MARK/Diseased_Exclusive_MARK_GRCh38.bed"
exportPath <- gsub("MARK", mark, exportPath)
rtracklayer::export(nonOverlapsPeaks, exportPath)
}
marks <- c("H3K4Me3", "H3K9Me3", "H3K27Ac", "H3K27Me3")
for (mark in marks) {
diseasedPath <- "ENCODE_peaks/MARK/Diseased_MARK_GRCh38_chr1.bigBed"
diseasedPath <- gsub("MARK", mark, diseasedPath)
print(diseasedPath)
diseasedPeaks <- rtracklayer::import(diseasedPath)
healthyPath <- "ENCODE_peaks/MARK/Healthy_MARK_GRCh38_chr1.bigBed"
healthyPath <- gsub("MARK", mark, healthyPath)
print(healthyPath)
healthyPeaks <- rtracklayer::import(healthyPath)
overlaps <- overlapsAny(diseasedPeaks, healthyPeaks)
print(table(overlaps))
nonOverlaps <- !overlaps
print(table(nonOverlaps))
nonOverlapsPeaks <- diseasedPeaks[nonOverlaps]
print(length(nonOverlapsPeaks))
exportPath <- "ENCODE_peaks/MARK/Diseased_Exclusive_MARK_GRCh38_chr1.bed"
exportPath <- gsub("MARK", mark, exportPath)
rtracklayer::export(nonOverlapsPeaks, exportPath)
}
diseasedPeakCount <- c()
marks <- c("H3K4Me3", "H3K9Me3", "H3K27Ac", "H3K27Me3")
for (mark in marks) {
diseasedPath <- "ENCODE_peaks/MARK/Diseased_MARK_GRCh38_chr1.bigBed"
diseasedPath <- gsub("MARK", mark, diseasedPath)
print(diseasedPath)
diseasedPeaks <- rtracklayer::import(diseasedPath)
healthyPath <- "ENCODE_peaks/MARK/Healthy_MARK_GRCh38_chr1.bigBed"
healthyPath <- gsub("MARK", mark, healthyPath)
print(healthyPath)
healthyPeaks <- rtracklayer::import(healthyPath)
overlaps <- overlapsAny(healthyPeaks, diseasedPeaks)
print(table(overlaps))
nonOverlaps <- !overlaps
print(table(nonOverlaps))
nonOverlapsPeaks <- healthyPeaks[nonOverlaps]
print(length(nonOverlapsPeaks))
exportPath <- "ENCODE_peaks/MARK/Healthy_Exclusive_MARK_GRCh38_chr1.bed"
exportPath <- gsub("MARK", mark, exportPath)
rtracklayer::export(nonOverlapsPeaks, exportPath)
}
marks <- c("H3K4Me3", "H3K9Me3", "H3K27Ac", "H3K27Me3")
for (mark in marks) {
diseasedPath <- "ENCODE_peaks/MARK/Diseased_MARK_GRCh38.bigBed"
diseasedPath <- gsub("MARK", mark, diseasedPath)
print(diseasedPath)
diseasedPeaks <- rtracklayer::import(diseasedPath)
healthyPath <- "ENCODE_peaks/MARK/Healthy_MARK_GRCh38.bigBed"
healthyPath <- gsub("MARK", mark, healthyPath)
print(healthyPath)
healthyPeaks <- rtracklayer::import(healthyPath)
overlaps <- overlapsAny(healthyPeaks, diseasedPeaks)
print(table(overlaps))
nonOverlaps <- !overlaps
print(table(nonOverlaps))
nonOverlapsPeaks <- healthyPeaks[nonOverlaps]
print(length(nonOverlapsPeaks))
exportPath <- "ENCODE_peaks/MARK/Healthy_Exclusive_MARK_GRCh38.bed"
exportPath <- gsub("MARK", mark, exportPath)
rtracklayer::export(nonOverlapsPeaks, exportPath)
}
marks <- c("H3K4Me3", "H3K9Me3", "H3K27Ac", "H3K27Me3")
for (mark in marks) {
diseasedPath <- "ENCODE_peaks/MARK/Diseased_MARK_GRCh38_chr1.bigBed"
diseasedPath <- gsub("MARK", mark, diseasedPath)
print(diseasedPath)
diseasedPeaks <- rtracklayer::import(diseasedPath)
healthyPath <- "ENCODE_peaks/MARK/Healthy_MARK_GRCh38_chr1.bigBed"
healthyPath <- gsub("MARK", mark, healthyPath)
print(healthyPath)
healthyPeaks <- rtracklayer::import(healthyPath)
overlaps <- overlapsAny(healthyPeaks, diseasedPeaks)
print(table(overlaps))
nonOverlaps <- !overlaps
print(table(nonOverlaps))
nonOverlapsPeaks <- healthyPeaks[nonOverlaps]
print(length(nonOverlapsPeaks))
exportPath <- "ENCODE_peaks/MARK/Healthy_Exclusive_MARK_GRCh38_chr1.bed"
exportPath <- gsub("MARK", mark, exportPath)
rtracklayer::export(nonOverlapsPeaks, exportPath)
}
?overlapsAny
length(healthyPeaks)
length(diseasedPeaks)
marks <- c("H3K4Me3", "H3K9Me3", "H3K27Ac", "H3K27Me3")
for (mark in marks) {
diseasedPath <- "ENCODE_peaks/MARK/Diseased_MARK_GRCh38_chr1.bigBed"
diseasedPath <- gsub("MARK", mark, diseasedPath)
print(diseasedPath)
diseasedPeaks <- rtracklayer::import(diseasedPath)
healthyPath <- "ENCODE_peaks/MARK/Healthy_MARK_GRCh38_chr1.bigBed"
healthyPath <- gsub("MARK", mark, healthyPath)
print(healthyPath)
healthyPeaks <- rtracklayer::import(healthyPath)
overlaps <- overlapsAny(diseasedPeaks, healthyPeaks)
print(table(overlaps))
nonOverlaps <- !overlaps
print(table(nonOverlaps))
nonOverlapsPeaks <- diseasedPeaks[nonOverlaps]
print(length(nonOverlapsPeaks))
exportPath <- "ENCODE_peaks/MARK/Diseased_Exclusive_MARK_GRCh38_chr1.bed"
exportPath <- gsub("MARK", mark, exportPath)
rtracklayer::export(nonOverlapsPeaks, exportPath)
}
test <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Diseased_H3K4Me3_GRCh38.bigBed")
length(test)
test <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38.bigBed")
length(test)
H4K4Me3 <- c(24631, 9792, 47173+32884-24631-9792)
pie(H3K4Me3, c("exclusive diseased", "exclusive healthy", "shared peaks"))
H3K4Me3 <- c(24631, 9792, 47173+32884-24631-9792)
pie(H3K4Me3, c("exclusive diseased", "exclusive healthy", "shared peaks"))
sum(H3K4Me3)
47173+32884
H3K4Me3 <- c(24631, 9792, 47173+32884-24631-9792)
sum(H3K4Me3)
pie(H3K4Me3, c("exclusive diseased", "exclusive healthy", "shared peaks"))
test <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K9Me3_GRCh38.bigBed")
test <- rtracklayer::import("ENCODE_peaks/H3K9Me3/Healthy_H3K9Me3_GRCh38.bigBed")
length(test)
test <- rtracklayer::import("ENCODE_peaks/H3K9Me3/Diseased_H3K9Me3_GRCh38.bigBed")
length(test)
H3K4Me3 <- c(24631, 9792, 47173+32884-24631-9792)
sum(H3K4Me3)
pie(H3K4Me3, c("exclusive diseased", "exclusive healthy", "shared peaks"))
H3K9Me3 <- c(6796, 149416, 13749+155871-6796-149416)
sum(H3K9Me3)
pie(H3K9Me3, c("exclusive diseased", "exclusive healthy", "shared peaks"))
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Diseased_H3K4Me3_GRCh38_chr1.bigBed")
disChr1H3K27Me3 <- rtracklayer::import("ENCODE_peaks/H3K27Me3/Diseased_H3K27Me3_GRCh38_chr1.bigBed")
test <- overlapsAny(disChr1H3K4Me3, disChr1H3K27Me3)
table(test)
test <- overlapsAny(disChr1H3K27Me3, disChr1H3K4Me3)
table(test)
#regionOverlaps(both, ignore.strand = TRUE)
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Diseased_H3K4Me3_GRCh38.bigBed")
disChr1H3K27Me3 <- rtracklayer::import("ENCODE_peaks/H3K27Me3/Diseased_H3K27Me3_GRCh38.bigBed")
test <- overlapsAny(disChr1H3K4Me3, disChr1H3K27Me3)
table(test)
test <- overlapsAny(disChr1H3K27Me3, disChr1H3K4Me3)
table(test)
#regionOverlaps(both, ignore.strand = TRUE)
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38.bigBed")
disChr1H3K27Me3 <- rtracklayer::import("ENCODE_peaks/H3K27Me3/Healthy_H3K27Me3_GRCh38.bigBed")
test <- overlapsAny(disChr1H3K4Me3, disChr1H3K27Me3)
table(test)
test <- overlapsAny(disChr1H3K27Me3, disChr1H3K4Me3)
table(test)
#regionOverlaps(both, ignore.strand = TRUE)
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38_chr1.bigBed")
disChr1H3K27Me3 <- rtracklayer::import("ENCODE_peaks/H3K27Me3/Healthy_H3K27Me3_GRCh38_chr1.bigBed")
test <- overlapsAny(disChr1H3K4Me3, disChr1H3K27Me3)
table(test)
test <- overlapsAny(disChr1H3K27Me3, disChr1H3K4Me3)
table(test)
#regionOverlaps(both, ignore.strand = TRUE)
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38_chr1.bigBed")
disChr1H3K27Me3 <- rtracklayer::import("ENCODE_peaks/H3K27Me3/Healthy_H3K27Me3_GRCh38_chr1.bigBed")
test <- overlapsAny(disChr1H3K4Me3, disChr1H3K27Me3)
table(test)
test <- overlapsAny(disChr1H3K27Me3, disChr1H3K4Me3)
table(test)
rtracklayer::export(test, "ENCODE_peaks/Bivalent/Healthy_Bivalent_GRCh38_chr1.bigBed")
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38_chr1.bigBed")
disChr1H3K27Me3 <- rtracklayer::import("ENCODE_peaks/H3K27Me3/Healthy_H3K27Me3_GRCh38_chr1.bigBed")
test <- overlapsAny(disChr1H3K4Me3, disChr1H3K27Me3)
table(test)
test <- overlapsAny(disChr1H3K27Me3, disChr1H3K4Me3)
table(test)
rtracklayer::export(disChr1H3K27Me3[test], "ENCODE_peaks/Bivalent/Healthy_Bivalent_GRCh38_chr1.bigBed")
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38_chr1.bigBed")
disChr1H3K27Me3 <- rtracklayer::import("ENCODE_peaks/H3K27Me3/Healthy_H3K27Me3_GRCh38_chr1.bigBed")
test <- overlapsAny(disChr1H3K4Me3, disChr1H3K27Me3)
table(test)
test <- overlapsAny(disChr1H3K27Me3, disChr1H3K4Me3)
table(test)
rtracklayer::export(disChr1H3K27Me3[test], "ENCODE_peaks/Bivalent/Healthy_Bivalent_GRCh38_chr1.bed")
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38.bigBed")
disChr1H3K27Me3 <- rtracklayer::import("ENCODE_peaks/H3K27Me3/Healthy_H3K27Me3_GRCh38.bigBed")
test <- overlapsAny(disChr1H3K4Me3, disChr1H3K27Me3)
table(test)
test <- overlapsAny(disChr1H3K27Me3, disChr1H3K4Me3)
table(test)
rtracklayer::export(disChr1H3K27Me3[test], "ENCODE_peaks/Bivalent/Healthy_Bivalent_GRCh38_chr1.bed")
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38_chr1.bigBed")
disChr1H3K27Me3 <- rtracklayer::import("ENCODE_peaks/H3K27Me3/Healthy_H3K27Me3_GRCh38_chr1.bigBed")
test <- overlapsAny(disChr1H3K4Me3, disChr1H3K27Me3)
table(test)
test <- overlapsAny(disChr1H3K27Me3, disChr1H3K4Me3)
table(test)
rtracklayer::export(disChr1H3K27Me3[test], "ENCODE_peaks/Bivalent/Healthy_Bivalent_GRCh38_chr1.bed")
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38.bigBed")
disChr1H3K27Me3 <- rtracklayer::import("ENCODE_peaks/H3K27Me3/Healthy_H3K27Me3_GRCh38.bigBed")
test <- overlapsAny(disChr1H3K4Me3, disChr1H3K27Me3)
table(test)
test <- overlapsAny(disChr1H3K27Me3, disChr1H3K4Me3)
table(test)
rtracklayer::export(disChr1H3K27Me3[test], "ENCODE_peaks/Bivalent/Healthy_Bivalent_GRCh38.bed")
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38.bigBed")
disChr1H3K27Me3 <- rtracklayer::import("ENCODE_peaks/H3K27Me3/Healthy_H3K27Me3_GRCh38.bigBed")
test <- overlapsAny(disChr1H3K27Me3, disChr1H3K4Me3)
table(test)
test <- overlapsAny(disChr1H3K4Me3, disChr1H3K27Me3)
table(test)
rtracklayer::export(disChr1H3K4Me3[test], "ENCODE_peaks/Bivalent/Healthy_Bivalent_GRCh38.bed")
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Healthy_H3K4Me3_GRCh38_chr1.bigBed")
disChr1H3K27Me3 <- rtracklayer::import("ENCODE_peaks/H3K27Me3/Healthy_H3K27Me3_GRCh38_chr1.bigBed")
test <- overlapsAny(disChr1H3K27Me3, disChr1H3K4Me3)
table(test)
test <- overlapsAny(disChr1H3K4Me3, disChr1H3K27Me3)
table(test)
rtracklayer::export(disChr1H3K4Me3[test], "ENCODE_peaks/Bivalent/Healthy_Bivalent_GRCh38_chr1.bed")
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Diseased_H3K4Me3_GRCh38_chr1.bigBed")
disChr1H3K27Me3 <- rtracklayer::import("ENCODE_peaks/H3K27Me3/Diseased_H3K27Me3_GRCh38_chr1.bigBed")
test <- overlapsAny(disChr1H3K27Me3, disChr1H3K4Me3)
table(test)
test <- overlapsAny(disChr1H3K4Me3, disChr1H3K27Me3)
table(test)
rtracklayer::export(disChr1H3K4Me3[test], "ENCODE_peaks/Bivalent/Diseased_Bivalent_GRCh38_chr1.bed")
disChr1H3K4Me3 <- rtracklayer::import("ENCODE_peaks/H3K4Me3/Diseased_H3K4Me3_GRCh38.bigBed")
disChr1H3K27Me3 <- rtracklayer::import("ENCODE_peaks/H3K27Me3/Diseased_H3K27Me3_GRCh38.bigBed")
test <- overlapsAny(disChr1H3K27Me3, disChr1H3K4Me3)
table(test)
test <- overlapsAny(disChr1H3K4Me3, disChr1H3K27Me3)
table(test)
rtracklayer::export(disChr1H3K4Me3[test], "ENCODE_peaks/Bivalent/Diseased_Bivalent_GRCh38.bed")
test <- rtracklayer::import("ENCODE_peaks/H3K27Ac/Diseased_H3K27Ac_GRCh38.bigBed")
length(test)
test <- rtracklayer::import("ENCODE_peaks/H3K27Ac/Healthy_H3K27Ac_GRCh38.bigBed")
length(test)
H3K4Me3 <- c(24631, 9792, 47173+32884-24631-9792)
sum(H3K4Me3)
pie(H3K4Me3, c("exclusive diseased", "exclusive healthy", "shared peaks"))
H3K9Me3 <- c(6796, 149416, 13749+155871-6796-149416)
sum(H3K9Me3)
pie(H3K9Me3, c("exclusive diseased", "exclusive healthy", "shared peaks"))
H3K27Ac <- c(19656, 31592, 36917+50871-19656-31592)
sum(H3K27Ac)
pie(H3K27Ac, c("exclusive diseased", "exclusive healthy", "shared peaks"))
test <- rtracklayer::import("ENCODE_peaks/H3K27Me3/Diseased_H3K27Me3_GRCh38.bigBed")
length(test)
test <- rtracklayer::import("ENCODE_peaks/H3K27Me3/Healthy_H3K27Me3_GRCh38.bigBed")
length(test)
H3K4Me3 <- c(24631, 9792, 47173+32884-24631-9792)
sum(H3K4Me3)
pie(H3K4Me3, c("exclusive diseased", "exclusive healthy", "shared peaks"))
H3K9Me3 <- c(6796, 149416, 13749+155871-6796-149416)
sum(H3K9Me3)
pie(H3K9Me3, c("exclusive diseased", "exclusive healthy", "shared peaks"))
H3K27Ac <- c(19656, 31592, 36917+50871-19656-31592)
sum(H3K27Ac)
pie(H3K27Ac, c("exclusive diseased", "exclusive healthy", "shared peaks"))
H3K27Me3 <- c(39445, 76377, 56005+98133-39445-76377)
sum(H3K27Me3)
pie(H3K27Me3, c("exclusive diseased", "exclusive healthy", "shared peaks"))
?pie
H3K4Me3 <- c(24631, 9792, 47173+32884-24631-9792)
sum(H3K4Me3)
pie(H3K4Me3, c("exclusive diseased", "exclusive healthy", "shared peaks"))
H3K9Me3 <- c(6796, 149416, 13749+155871-6796-149416)
sum(H3K9Me3)
pie(H3K9Me3, c("exclusive diseased", "exclusive healthy", "shared peaks"), col=c("orangered4", "orangered3", "orangered2"))
H3K27Ac <- c(19656, 31592, 36917+50871-19656-31592)
sum(H3K27Ac)
pie(H3K27Ac, c("exclusive diseased", "exclusive healthy", "shared peaks"))
H3K27Me3 <- c(39445, 76377, 56005+98133-39445-76377)
sum(H3K27Me3)
pie(H3K27Me3, c("exclusive diseased", "exclusive healthy", "shared peaks"))
H3K4Me3 <- c(24631, 9792, 47173+32884-24631-9792)
sum(H3K4Me3)
pie(H3K4Me3, c("exclusive diseased", "exclusive healthy", "shared peaks"))
H3K9Me3 <- c(6796, 149416, 13749+155871-6796-149416)
sum(H3K9Me3)
pie(H3K9Me3, c("exclusive diseased", "exclusive healthy", "shared peaks"), col=c("orangered4", "orangered3", "orangered2"))
H3K27Ac <- c(19656, 31592, 36917+50871-19656-31592)
sum(H3K27Ac)
pie(H3K27Ac, c("exclusive diseased", "exclusive healthy", "shared peaks"))
H3K27Me3 <- c(39445, 76377, 56005+98133-39445-76377)
sum(H3K27Me3)
pie(H3K27Me3, c("exclusive diseased", "exclusive healthy", "shared peaks"), col=c("orange4", "orange3", "orange2"))
H3K4Me3 <- c(24631, 9792, 47173+32884-24631-9792)
sum(H3K4Me3)
pie(H3K4Me3, c("exclusive diseased", "exclusive healthy", "shared peaks"), col=c("springgreen4", "springgreen3", "springgreen2"))
H3K9Me3 <- c(6796, 149416, 13749+155871-6796-149416)
sum(H3K9Me3)
pie(H3K9Me3, c("exclusive diseased", "exclusive healthy", "shared peaks"), col=c("orangered4", "orangered3", "orangered2"))
H3K27Ac <- c(19656, 31592, 36917+50871-19656-31592)
sum(H3K27Ac)
pie(H3K27Ac, c("exclusive diseased", "exclusive healthy", "shared peaks"), col=c("springgreen4", "springgreen3", "springgreen2"))
H3K27Me3 <- c(39445, 76377, 56005+98133-39445-76377)
sum(H3K27Me3)
pie(H3K27Me3, c("exclusive diseased", "exclusive healthy", "shared peaks"), col=c("orange4", "orange3", "orange2"))
H3K4Me3 <- c(24631, 9792, 47173+32884-24631-9792)
pie(H3K4Me3, main = "H3K4Me3", c("exclusive diseased", "exclusive healthy", "shared peaks"), col=c("springgreen4", "springgreen3", "springgreen2"))
H3K9Me3 <- c(6796, 149416, 13749+155871-6796-149416)
pie(H3K9Me3, main = "H3K9Me3", c("exclusive diseased", "exclusive healthy", "shared peaks"), col=c("orangered4", "orangered3", "orangered2"))
H3K27Ac <- c(19656, 31592, 36917+50871-19656-31592)
pie(H3K27Ac, main = "H3K27Ac", c("exclusive diseased", "exclusive healthy", "shared peaks"), col=c("springgreen4", "springgreen3", "springgreen2"))
H3K27Me3 <- c(39445, 76377, 56005+98133-39445-76377)
pie(H3K27Me3, main = "H3K27Me3", c("exclusive diseased", "exclusive healthy", "shared peaks"), col=c("orange4", "orange3", "orange2"))
par(mfrow=c(2,2))
H3K4Me3 <- c(24631, 9792, 47173+32884-24631-9792)
pie(H3K4Me3, main = "H3K4Me3", c("exclusive diseased", "exclusive healthy", "shared peaks"), col=c("springgreen4", "springgreen3", "springgreen2"))
H3K9Me3 <- c(6796, 149416, 13749+155871-6796-149416)
pie(H3K9Me3, main = "H3K9Me3", c("exclusive diseased", "exclusive healthy", "shared peaks"), col=c("orangered4", "orangered3", "orangered2"))
H3K27Ac <- c(19656, 31592, 36917+50871-19656-31592)
pie(H3K27Ac, main = "H3K27Ac", c("exclusive diseased", "exclusive healthy", "shared peaks"), col=c("springgreen4", "springgreen3", "springgreen2"))
H3K27Me3 <- c(39445, 76377, 56005+98133-39445-76377)
pie(H3K27Me3, main = "H3K27Me3", c("exclusive diseased", "exclusive healthy", "shared peaks"), col=c("orange4", "orange3", "orange2"))
bivDiseased <- rtracklayer::import("ENCODE_peaks/Bivalent/Diseased_Bivalent_GRCh38.bigBed")
bivDiseased <- rtracklayer::import("ENCODE_peaks/Bivalent/Diseased_Bivalent_GRCh38.bed")
bivHealthy <- rtracklayer::import("ENCODE_peaks/Bivalent/Healthy_Bivalent_GRCh38.bed")
bivDiseased <- rtracklayer::import("ENCODE_peaks/Bivalent/Diseased_Bivalent_GRCh38.bed")
bivHealthy <- rtracklayer::import("ENCODE_peaks/Bivalent/Healthy_Bivalent_GRCh38.bed")
bivalentOverlaps <- overlapsAny(bivHealthy, bivDiseased)
(length(bivalentOverlaps) + length(bivHealthy)) / length(bivalentOverlaps) * 100
bivDiseased <- rtracklayer::import("ENCODE_peaks/Bivalent/Diseased_Bivalent_GRCh38.bed")
bivHealthy <- rtracklayer::import("ENCODE_peaks/Bivalent/Healthy_Bivalent_GRCh38.bed")
bivalentOverlaps <- overlapsAny(bivHealthy, bivDiseased)
length(bivalentOverlaps)
(length(bivalentOverlaps) + length(bivHealthy)) / length(bivalentOverlaps) * 100
bivDiseased
bivDiseased
bivHealthy
bivDiseased <- rtracklayer::import("ENCODE_peaks/Bivalent/Diseased_Bivalent_GRCh38.bed")
bivHealthy <- rtracklayer::import("ENCODE_peaks/Bivalent/Healthy_Bivalent_GRCh38.bed")
bivalentOverlaps <- overlapsAny(bivHealthy, bivDiseased)
bivalentOverlaps <- bivHealthy[bivalentOverlaps]
length(bivalentOverlaps)
(length(bivalentOverlaps) + length(bivHealthy)) / length(bivalentOverlaps) * 100
bivDiseased <- rtracklayer::import("ENCODE_peaks/Bivalent/Diseased_Bivalent_GRCh38.bed")
bivHealthy <- rtracklayer::import("ENCODE_peaks/Bivalent/Healthy_Bivalent_GRCh38.bed")
bivalentOverlaps <- overlapsAny(bivHealthy, bivDiseased)
bivalentOverlaps <- bivHealthy[bivalentOverlaps]
length(bivalentOverlaps)
length(bivalentOverlaps) / length(bivHealthy)
bivDiseased <- rtracklayer::import("ENCODE_peaks/Bivalent/Diseased_Bivalent_GRCh38.bed")
bivHealthy <- rtracklayer::import("ENCODE_peaks/Bivalent/Healthy_Bivalent_GRCh38.bed")
bivalentOverlaps <- overlapsAny(bivHealthy, bivDiseased)
bivalentOverlaps <- bivHealthy[bivalentOverlaps]
length(bivalentOverlaps)
length(bivalentOverlaps) / length(bivHealthy) * 100
library(MotifDb)
library(MotifDb.Genome)
data(hg38MotifDb)
